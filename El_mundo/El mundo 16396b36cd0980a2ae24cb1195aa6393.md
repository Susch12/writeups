# El mundo

Class: pwn
Status: Done

Al extraer el reto contiene los siguientes archivos

![image.png](image.png)

Ya que viene con un template para resolver el reto, veremos que hace 

![image.png](image%201.png)

Parece un script no tan complicado y podemos asumir que se trata de un código ret2win. Haremos un pequeño al binario para ver cómo funciona el programa. 

![image.png](image%202.png)

Con ghidra podemos ver que hace con la función main, lo cual nos indica que debemos cambiar la instrucción ret hacia la función que nos dará la flag. Con ghidra podemos encontrar la función que nos dará la flag, que es la siguiente:

![image.png](image%203.png)

Okay, podríamos revisar la dirección con ghidra en la tabla de simbolos, sin embargo, en la función main parece que nos brinda la dirección a la que debemos ir. 

![image.png](image%204.png)

Al ejeuctar el binario nos brinda todo el apoyo para realizar el reto, entonces podríamos haber omitido el análisis con Ghidra. Continuemos al parecer debemos cambiar el Return addr así que debemos llegar por lo menos a 56 bytes. 

Al ingresar la cantidad de 56 bytes el programa tiene el siguiente output:

![image.png](image%205.png)

Por ejemplo si intentaramos enviar una cadena menor el output será el siguiente 

![image.png](image%206.png)

Podriamos enviar la dirección manualmente, pero debido a que se nos brinda un template es lo que usaremos.

Entonces el exploit, sería el siguiente: 

![image.png](image%207.png)

Lo ejecutamos y está listo: 

![image.png](image%208.png)

![image.png](image%209.png)