<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Hereâ€™s LIBC - PicoCTF </title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
	margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(50, 48, 44, 1);
}
.highlight-gray {
	color: rgba(115, 114, 110, 1);
	fill: rgba(115, 114, 110, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(205, 60, 58, 1);
	fill: rgba(205, 60, 58, 1);
}
.highlight-default_background {
	color: rgba(50, 48, 44, 1);
}
.highlight-gray_background {
	background: rgba(248, 248, 247, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(248, 243, 252, 1);
}
.highlight-pink_background {
	background: rgba(252, 241, 246, 1);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(115, 114, 110, 1);
	fill: rgba(115, 114, 110, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(205, 60, 58, 1);
	fill: rgba(205, 60, 58, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(248, 248, 247, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(248, 243, 252, 1);
}
.block-color-pink_background {
	background: rgba(252, 241, 246, 1);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-uiBlue { background-color: undefined; }
.select-value-color-pink { background-color: rgba(225, 136, 179, 0.27); }
.select-value-color-purple { background-color: rgba(168, 129, 197, 0.27); }
.select-value-color-green { background-color: rgba(123, 183, 129, 0.27); }
.select-value-color-gray { background-color: rgba(84, 72, 49, 0.15); }
.select-value-color-translucentGray { background-color: undefined; }
.select-value-color-orange { background-color: rgba(224, 124, 57, 0.27); }
.select-value-color-brown { background-color: rgba(210, 162, 141, 0.35); }
.select-value-color-red { background-color: rgba(244, 171, 159, 0.4); }
.select-value-color-yellow { background-color: rgba(236, 191, 66, 0.39); }
.select-value-color-blue { background-color: rgba(93, 165, 206, 0.27); }
.select-value-color-pageGlass { background-color: undefined; }
.select-value-color-washGlass { background-color: undefined; }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="13296b36-cd09-80e3-ac06-fe81c18c63c8" class="page sans"><header><div class="page-header-icon undefined"><span class="icon">ðŸ’»</span></div><h1 class="page-title">Hereâ€™s LIBC - PicoCTF </h1><p class="page-description"></p><table class="properties"><tbody><tr class="property-row property-row-select"><th><span class="icon property-icon"><svg aria-hidden="true" role="graphics-symbol" viewBox="0 0 16 16" style="width:14px;height:14px;display:block;fill:rgba(71, 70, 68, 0.6);flex-shrink:0" class="typesSelect"><path d="M8 15.126C11.8623 15.126 15.0615 11.9336 15.0615 8.06445C15.0615 4.20215 11.8623 1.00293 7.99316 1.00293C4.13086 1.00293 0.938477 4.20215 0.938477 8.06445C0.938477 11.9336 4.1377 15.126 8 15.126ZM8 13.7383C4.85547 13.7383 2.33301 11.209 2.33301 8.06445C2.33301 4.91992 4.84863 2.39746 7.99316 2.39746C11.1377 2.39746 13.6738 4.91992 13.6738 8.06445C13.6738 11.209 11.1445 13.7383 8 13.7383ZM7.62402 10.6348C7.79492 10.915 8.20508 10.9287 8.37598 10.6348L10.666 6.73145C10.8574 6.41016 10.7002 6.04102 10.3652 6.04102H5.62793C5.29297 6.04102 5.14941 6.43066 5.32031 6.73145L7.62402 10.6348Z"></path></svg></span>Class</th><td><span class="selected-value select-value-color-green">pwn</span></td></tr><tr class="property-row property-row-status"><th><span class="icon property-icon"><svg aria-hidden="true" role="graphics-symbol" viewBox="0 0 16 16" style="width:14px;height:14px;display:block;fill:rgba(71, 70, 68, 0.6);flex-shrink:0" class="typesStatus"><path d="M8.75488 1.02344C8.75488 0.613281 8.41309 0.264648 8.00293 0.264648C7.59277 0.264648 7.25098 0.613281 7.25098 1.02344V3.11523C7.25098 3.51855 7.59277 3.86719 8.00293 3.86719C8.41309 3.86719 8.75488 3.51855 8.75488 3.11523V1.02344ZM3.91504 5.0293C4.20215 5.31641 4.69434 5.32324 4.97461 5.03613C5.26855 4.74902 5.26855 4.25684 4.98145 3.96973L3.53906 2.52051C3.25195 2.2334 2.7666 2.21973 2.47949 2.50684C2.19238 2.79395 2.18555 3.28613 2.47266 3.57324L3.91504 5.0293ZM10.9629 4.01758C10.6826 4.30469 10.6826 4.79688 10.9697 5.08398C11.2568 5.37109 11.749 5.36426 12.0361 5.07715L13.4854 3.62793C13.7725 3.34082 13.7725 2.84863 13.4785 2.55469C13.1982 2.27441 12.7061 2.27441 12.4189 2.56152L10.9629 4.01758ZM15.0234 8.78906C15.4336 8.78906 15.7822 8.44727 15.7822 8.03711C15.7822 7.62695 15.4336 7.28516 15.0234 7.28516H12.9385C12.5283 7.28516 12.1797 7.62695 12.1797 8.03711C12.1797 8.44727 12.5283 8.78906 12.9385 8.78906H15.0234ZM0.975586 7.28516C0.56543 7.28516 0.223633 7.62695 0.223633 8.03711C0.223633 8.44727 0.56543 8.78906 0.975586 8.78906H3.07422C3.48438 8.78906 3.83301 8.44727 3.83301 8.03711C3.83301 7.62695 3.48438 7.28516 3.07422 7.28516H0.975586ZM12.0361 10.9902C11.749 10.71 11.2568 10.71 10.9629 10.9971C10.6826 11.2842 10.6826 11.7764 10.9697 12.0635L12.4258 13.5127C12.7129 13.7998 13.2051 13.793 13.4922 13.5059C13.7793 13.2256 13.7725 12.7266 13.4854 12.4395L12.0361 10.9902ZM2.52051 12.4395C2.22656 12.7266 2.22656 13.2188 2.50684 13.5059C2.79395 13.793 3.28613 13.7998 3.57324 13.5127L5.02246 12.0703C5.31641 11.7832 5.31641 11.291 5.03613 11.0039C4.74902 10.7168 4.25684 10.71 3.96973 10.9971L2.52051 12.4395ZM8.75488 12.9658C8.75488 12.5557 8.41309 12.207 8.00293 12.207C7.59277 12.207 7.25098 12.5557 7.25098 12.9658V15.0576C7.25098 15.4609 7.59277 15.8096 8.00293 15.8096C8.41309 15.8096 8.75488 15.4609 8.75488 15.0576V12.9658Z"></path></svg></span>Status</th><td><span class="status-value select-value-color-green"><div class="status-dot status-dot-color-green"></div>Done</span></td></tr></tbody></table></header><div class="page-body"><figure id="13296b36-cd09-804a-b762-f91eb9f570c1" class="image"><a href="image.png"><img style="width:707.9874877929688px" src="image.png"/></a></figure><p id="13296b36-cd09-8056-9ec1-cf6855a4ac63" class="">
</p><p id="13296b36-cd09-8047-8d06-fde99a5f59b1" class="">We have access to a binary called vuln, the library, and a Makefile. </p><p id="13296b36-cd09-803d-8b0a-cbe58908ecea" class="">
</p><p id="13296b36-cd09-807e-ac0a-e960ce5c4010" class="">We use the checksec command to validate the security protections of the binary, which returns the following values:.<br/><br/></p><figure id="13296b36-cd09-80d9-8b15-dfa7b79d7644" class="image"><a href="image%201.png"><img style="width:644.984375px" src="image%201.png"/></a></figure><p id="13296b36-cd09-8081-8ece-c36ba7fe97a9" class="">At the same time, we check what type of file weâ€™re dealing with using the file command: </p><figure id="13296b36-cd09-80e6-9abc-d6fab0c482c1" class="image"><a href="image%202.png"><img style="width:707.9750366210938px" src="image%202.png"/></a></figure><p id="13296b36-cd09-8077-87c0-e0c0ff3a7b4b" class="">As we can see, itâ€™s a 64-bit binary, which will matter during exploitation since 64-bit binaries behave differently than 32-bit ones.</p><p id="13296b36-cd09-8021-8293-ef6ac1e29a68" class="">
</p><p id="13296b36-cd09-800d-9079-e166181fab67" class="">Since we donâ€™t have the source code, weâ€™ll use a reverse engineering tool to analyze what the binary does. In this case, weâ€™ll use Ghidra, which lets us inspect the programâ€™s behavior. </p><p id="13296b36-cd09-8060-9d99-e248b654e592" class="">
</p><p id="13296b36-cd09-8050-8c8d-e90f6e27f731" class="">After analyzing it in Ghidra, we notice the following functions:<br/>  <br/></p><figure id="13296b36-cd09-8005-bd2f-cedcd20a2047" class="image"><a href="image%203.png"><img style="width:262px" src="image%203.png"/></a></figure><p id="13296b36-cd09-803d-a972-d2ce43357928" class="">
</p><p id="13296b36-cd09-80ef-9de6-d95650d25e17" class="">We start analyzing the main() function, which shows us the following code:<br/> <br/></p><figure id="13296b36-cd09-80f4-b0b1-ed98779ae9fd" class="image"><a href="image%204.png"><img style="width:707.9874877929688px" src="image%204.png"/></a></figure><p id="13296b36-cd09-8019-8e93-f5a8991847e3" class="">
</p><p id="13296b36-cd09-807a-a90e-fd1de66a5f74" class="">We see variable declarations and various operations with the following:</p><ul id="13296b36-cd09-80fc-9cc3-db560e596114" class="bulleted-list"><li style="list-style-type:disc"><code>local_78</code>, <code>local_70</code>, <code>local_68</code>, <code>local_60</code> and <code>local_5e</code> contain values that seem to represent a string encoded in ASCII hex. When decoded, the message is: <code>&quot;Welcome to my secret server!&quot;</code>.</li></ul><ul id="13296b36-cd09-80d6-8f3a-c0703181a916" class="bulleted-list"><li style="list-style-type:disc"><code>local_40</code>is set to <code>0x1b</code>,which is 27 in decimal, and appears to represent the messageâ€™s length.</li></ul><p id="13296b36-cd09-80f0-952d-c00ad9117675" class="">
</p><p id="13296b36-cd09-805a-8032-d43067100474" class="">Then, a <code>for</code> loop iterates over the message stored in the above variables. Inside the loop, it calls the function <code>convert_case</code>  on each character, likely toggling its case (uppercase/lowercase), and stores the result in <code>local_50</code>,  which points to <code>acStack_a8</code>.Then it prints the content of local_50 using puts(). After that, it enters a loop via the do_stuff() function. Now letâ€™s look at what do_stuff() does:</p><p id="13296b36-cd09-80e4-840f-df2c746803be" class="">
</p><figure id="13296b36-cd09-8089-8936-cc5069df9e3a" class="image"><a href="image%205.png"><img style="width:707.9874877929688px" src="image%205.png"/></a></figure><p id="13296b36-cd09-80d2-b007-c6deb76eeb31" class="">
</p><p id="13296b36-cd09-80b5-8539-fb163c4e045f" class="">It reads input from the user, does some operation depending on the contents of DAT_0040093a, converts the first 100 characters of the input, and prints this new string. </p><p id="13296b36-cd09-801c-939d-db86652c2edb" class="">
</p><p id="13296b36-cd09-800a-b69a-de56657a30ff" class="">We assume this is a ret2libc challenge.c<br/><br/>Weâ€™ll exploit it in two main steps: <br/></p><p id="13296b36-cd09-801a-8f7e-de2319c646ae" class="">First. Leak the address of the libc library. Second. Call the /bin/sh function from libc to gain control of the system. To do this, weâ€™ll write a script to help us get the flag.</p><p id="13296b36-cd09-807a-9289-e9bc1ea230b0" class="">
</p><p id="13296b36-cd09-802e-8fc5-d05bf1c09065" class="">Important: To build our script, we need to find gadgets using ROPgadget for our ROP chain.</p><p id="13296b36-cd09-8019-85a8-e86cdda3630f" class="">It would look like this: <br/><br/></p><figure id="13296b36-cd09-80f0-bf2a-ea00f8863f72" class="image"><a href="image%206.png"><img style="width:707.9874877929688px" src="image%206.png"/></a></figure><p id="13296b36-cd09-8072-bbc4-cf0ae25f9ff5" class="">Nota: </p><p id="13296b36-cd09-80e0-ab9c-e9303eee37ee" class="">In a ret2libc attack, the idea is to divert execution to a function in the standard C library, such as system, to execute an arbitrary command (for example, &quot;/bin/sh&quot; to get a shell). To call a function in libc, you usually need to pass specific arguments in registers or on the stack. On x86_64 (64-bit) based systems, the function calling standard (ABI) indicates that the first arguments are passed in the rdi, rsi, and rdx registers (in this order).</p><p id="13296b36-cd09-80cf-88f0-c4a67e9d5a47" class="">A pop rdi; ret gadget, for example, is useful because it allows you to place a controlled value (such as &quot;/bin/sh&quot;) in the rdi register, which is the first system parameter.</p><p id="13296b36-cd09-8010-85c7-dedf9b064415" class="">
</p><p id="13296b36-cd09-80a3-8dc7-f0408daa615c" class="">For this particular case we will need two instructions as first instruction I decided to use as first gadget the following one:<br/><br/></p><figure id="13296b36-cd09-8050-8a83-f67c399e9695" class="image"><a href="image%207.png"><img style="width:494px" src="image%207.png"/></a></figure><p id="13296b36-cd09-80de-98e8-d580d1d1f8be" class="">
</p><p id="13296b36-cd09-8098-9cc7-f518814fdccf" class="">And as a second I chose the following gadget: <br/><br/></p><figure id="13296b36-cd09-80fc-8ae4-d1915fca7b7c" class="image"><a href="image%208.png"><img style="width:546.890625px" src="image%208.png"/></a></figure><p id="13296b36-cd09-8007-82f5-f4d1a9ac8f96" class="">  <br/>With the help of ghidra and the function table .got.plt we obtain the address of the gets function that we will use for our ROP chain<br/></p><p id="13296b36-cd09-8090-9ab1-d20092161d0e" class="">
</p><figure id="13296b36-cd09-80f8-897b-fa30613a78e2" class="image"><a href="image%209.png"><img style="width:707.9750366210938px" src="image%209.png"/></a></figure><figure id="13296b36-cd09-808a-ab51-c40fee002923" class="image"><a href="image%2010.png"><img style="width:262px" src="image%2010.png"/></a></figure><p id="13296b36-cd09-8066-9f38-e540da2219f6" class="">While to find we can find the address with a debugger like gef, this in order to show other options to ghidra</p><figure id="13296b36-cd09-806c-93a0-e05ee9e9cdb8" class="image"><a href="image%2011.png"><img style="width:480px" src="image%2011.png"/></a></figure><p id="13296b36-cd09-8034-bb92-d29e0ab83edb" class="">So our script would look like this:<br/><br/></p><figure id="13296b36-cd09-80c8-822c-cfcb7e3c4f5c" class="image"><a href="image%2012.png"><img style="width:546.984375px" src="image%2012.png"/></a></figure><p id="13296b36-cd09-8010-9fb3-e6062f3eac2f" class="">
</p><p id="13296b36-cd09-804c-bf65-c8b5ec18e569" class="">Where the variable result will be storing the leaked address of the library</p><p id="13296b36-cd09-8049-90fa-f5f849f429ce" class="">In the following lines we format it for when printing the read address </p><figure id="13296b36-cd09-80ca-b3c9-f92ff67ff63c" class="image"><a href="image%2013.png"><img style="width:525px" src="image%2013.png"/></a></figure><p id="13296b36-cd09-8000-ab04-f11bb436bb76" class="">
</p><p id="13296b36-cd09-80a4-811b-fae27f465815" class="">Already with the leak, we calculate the libc base and with that we can discover the addresses to call a /bin/sh and the system function</p><p id="13296b36-cd09-80bd-a596-c291dd2331b8" class="">Now we look for the address of puts in libc.so.6 with the objdump tool</p><figure id="13296b36-cd09-8022-b668-dad56af230fd" class="image"><a href="image%2014.png"><img style="width:510px" src="image%2014.png"/></a></figure><p id="13296b36-cd09-8012-a5ac-cd880937a426" class="">We subtract this to get the base of libc, now we will go to find the address of /bin/sh and the system function in libc.so.6.</p><p id="13296b36-cd09-80c6-b041-d128034996eb" class="">
</p><p id="13296b36-cd09-8014-8694-f6f8091c72da" class="">We start with the system function and get the following:</p><figure id="13296b36-cd09-807b-b4be-f34217668caa" class="image"><a href="image%2015.png"><img style="width:547px" src="image%2015.png"/></a></figure><p id="13296b36-cd09-80f2-b381-caf6501697e7" class="">Now all that is missing is /bin/sh, which can be found with the following command: <br/><br/></p><figure id="13296b36-cd09-8085-bcb8-c42f6d853ec3" class="image"><a href="image%2016.png"><img style="width:546.90625px" src="image%2016.png"/></a></figure><p id="13296b36-cd09-8049-8b55-ef4234ac3789" class="">
</p><p id="13296b36-cd09-803c-a9fa-d64c96e7524b" class="">Now yes, we will continue with the following calculations to arrive at the addresses</p><figure id="13296b36-cd09-809d-afef-fe939da11fa8" class="image"><a href="image%2017.png"><img style="width:430px" src="image%2017.png"/></a></figure><p id="13296b36-cd09-8056-ad6f-cd201de74fe7" class="">
</p><p id="13296b36-cd09-8013-8c2d-eb96b0f47e3c" class="">Now we are going to build the second payload to get our shell</p><figure id="13296b36-cd09-80e1-add0-dab6e9187777" class="image"><a href="image%2018.png"><img style="width:525px" src="image%2018.png"/></a></figure><p id="13296b36-cd09-80e2-9ce4-c5373e81d042" class="">
</p><p id="13296b36-cd09-80c7-9963-f0b5ec9e04a8" class="">Our complete payload would look like this<br/><br/></p><figure id="13296b36-cd09-800d-91fd-eaf3c0127071" class="image"><a href="image%2019.png"><img style="width:707.9874877929688px" src="image%2019.png"/></a></figure><p id="13296b36-cd09-808c-abd5-ea2e32fc28be" class="">
</p><p id="13296b36-cd09-80b5-9f77-e82d76c1a7a9" class="">We tested it and it does indeed work. </p><p id="13296b36-cd09-80c2-a15c-f779937052d8" class="">
</p><figure id="13296b36-cd09-8066-b077-d9f364db4315" class="image"><a href="image%2020.png"><img style="width:707.9625244140625px" src="image%2020.png"/></a></figure><figure id="13296b36-cd09-80ce-b855-ffff39d9c76f" class="image"><a href="image%2021.png"><img style="width:546.984375px" src="image%2021.png"/></a></figure><p id="13296b36-cd09-809d-a149-d1d0236b7419" class="">
</p></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>
