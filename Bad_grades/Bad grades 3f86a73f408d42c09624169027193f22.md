# Bad grades

Class: pwn
Status: Done

Iniciamos analizando en binario proporcionado

![Untitled](Untitled.png)

Comportamiento:

![Untitled](Untitled%201.png)

![Untitled](Untitled%202.png)

Buscando un poco en ghidra podemos darnos cuenta de la función main es la siguiente:

![Untitled](Untitled%203.png)

Encontramos la función perteneciente a agregar notas 

![Untitled](Untitled%204.png)

El buffer es de un espacio [33] bytes, entoces para realizar necesitamos algo mayor.

Hacemos una prueba 

![Untitled](Untitled%205.png)

Necesitamos intentar un ret2lib 
Monte el siguiente script:

![Untitled](Untitled%206.png)

![Untitled](Untitled%207.png)

![Untitled](Untitled%208.png)

![Untitled](Untitled%209.png)

Ejecución del script

![Untitled](Untitled%2010.png)

![Untitled](Untitled%2011.png)